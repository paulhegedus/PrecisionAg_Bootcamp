
# PrecisionAg_Bootcamp

This project contains the code for running the net-return and nitrogen
applied comparisons between management strategies defined by students in
the Montana State University Precision Agriculture Bootcamp
course/certificate. The comparisons are generated from the
‘PA_Class_Script.Rmd’ file which draws on functions from
‘pa_class_fxns.R’ and the trained model in ‘model_source.R’.

## Workflow

General workflow of the script for running simulations to compare
outcomes among management strategies defined by groups of students. The
students split into groups and are given data that a farmer would have
at the time they need to make a decision about nitrogen fertilzier
management in Montana. These data include topographic measurements like
elevation, slope, topographic position index, and aspect. They also
include weather measurements like precipitation and growing degree days
and vegetation index measurements like NDVI and NDWI. Finally, soil
characteristics are provided for variables such as clay and sand
content, water content, soil organic carbon content, pH of soil water,
and bulk density.

Students look at the data or load it into QGIS and design a management
strategy by splitting the field into management zones. They then will
give these to us to run the simulations.

### Optimization Solution

To compare the performance of student’s prescribed N fertilizer rates to
the optimized N fertilizer rates generated by the OFPE framework, the
OFPE simulation is performed with just the economic parameters from
2021. The same maps and outputs are created, along with the total and
mean N applied, net-return, yield, and protein.

**This step should be performed ASAP depending on time constraints and
length of time to run analysis. Perhaps could be pre-defined. This would
entail running it beforehand to generate the maps and .Rdata files 1)
with the output table and 2) with the trained model for simulations of
student strategies.**

### Import Management Strategies

First, the strategies are imported into R. These will come in as polygon
shapefiles that are extracted to the 10m grid locations in a dataset
containing all the parameters needed to predict yield and protein.

### Simulation Loop

For each management strategy, the dataset with the student’s prescribed
N fertilizer rates and environmental covariates are passed to a function
that predicts yield and protein at each point in the field. Net-return
is calculated using the yield and protein predictions with economic data
from 2021. The parameter ‘conv’ is the base price received for a bushel
of wheat, the ‘cost’ is the price for one pound of nitrogen fertilizer,
and ‘FC’ are fixed costs associated with agronomic production
(e.g. fuel, rent, electricity, labor, etc.).

    #>    Year  org conv cost     FC
    #> 99 2021 9.12 7.24  0.4 182.41

### Outputs

For each management strategy four maps are generated; the prescribed N
fertilizer rates, the predicted yield, the predicted protein, and the
predicted net-return. As subheaders in each map, the total and mean of
the metric are reported. Additionally, a table for each group of
student’s prescription is generated with the information about total and
mean responses. For grain protein concentration, the mean protein
percent is reported as well as the mean and total mass of protein in the
yield (percent protein \* yield).

### Comparisons

To compare the management strategies, along with our optimized
prescription, all of the output tables need to be compiled. These are
put together and separated by metric to create figures. For each metric
a bar plot of the metric is generated. The bars are labeled with the
total or the mean value for each group/OFPE result. The list of figures
created are;

-   Total Net-Return ($/ac) vs. Strategy (all groups + OFPE method) with
    values labeled above bars (HIGHEST = BEST)
-   Mean Net-Return ($/ac) vs. Strategy (all groups + OFPE method) with
    values labeled above bars (HIGHEST = BEST)
-   Total Nitrogen Fertilizer Applied (tons) vs. Strategy (all groups +
    OFPE method) with values labeled above bars (LOWEST = BEST)
-   Mean Nitrogen Fertilizer Applied (lbs/ac) vs. Strategy (all groups +
    OFPE method) with values labeled above bars (LOWEST = BEST)
-   Total Grain Yield (bu/ac) vs. Strategy (all groups + OFPE method)
    with values labeled above bars (HIGHEST = BEST)
-   Mean Grain Yield (bu/ac) vs. Strategy (all groups + OFPE method)
    with values labeled above bars (HIGHEST = BEST)
-   Total Protein as Percent of Yield (bu/ac) vs. Strategy (all groups +
    OFPE method) with values labeled above bars (HIGHEST = BEST)
-   Mean Protein as Percent of Yield (bu/ac) vs. Strategy (all groups +
    OFPE method) with values labeled above bars (HIGHEST = BEST)
-   Mean Grain Protein Concentration (%) vs. Strategy (all groups + OFPE
    method) with values labeled above bars (HIGHEST = BEST)
